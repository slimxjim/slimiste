/*
Created: 10.5.2014
Modified: 11.5.2014
Model: MySQL 5.5
Database: MySQL 5.5
*/

-- Create tables section -------------------------------------------------

-- Table TRANSACTION

CREATE TABLE TRANSACTION
(
  ID Int NOT NULL AUTO_INCREMENT,
  VALUE_DATE Date NOT NULL,
  POSTING_DATE Date,
  AMOUNT Float(2) NOT NULL,
  CURRENCY Char(6),
  MOVEMENT_TYPE Text,
  PURPOSE_OF_PAYMENT Text,
  CATEGORY Text,
  BANK_REF Text,
  VARIABLE_SYMBOL Int,
  PERSONAL_DESCRIPTION Text,
 PRIMARY KEY (ID),
 UNIQUE ID (ID)
)
;

-- Table PARTNER_ACCOUNT

CREATE TABLE PARTNER_ACCOUNT
(
  ID Int NOT NULL AUTO_INCREMENT,
  TRANSACTION_ID Int NOT NULL,
  ACCOUNT_NUMBER Text,
  ACCOUNT_BANKCODE Int(4),
  ACCOUNT_NAME Text,
 PRIMARY KEY (ID,TRANSACTION_ID),
 UNIQUE ID (ID)
)
;

-- Table CLIENT_ACCOUNT

CREATE TABLE CLIENT_ACCOUNT
(
  ID Int NOT NULL AUTO_INCREMENT,
  TRANSACTION_ID Int NOT NULL,
  ACCOUNT_NUMBER Text,
  ACCOUNT_BANKCODE Int(4),
  ACCOUNT_IBAN Text,
 PRIMARY KEY (ID,TRANSACTION_ID),
 UNIQUE ID (ID)
)
;

-- Table TRANSACTION_FROM_HTML

CREATE TABLE TRANSACTION_FROM_HTML
(
  ID Int NOT NULL AUTO_INCREMENT,
  TRANSACTION_ID Int NOT NULL,
  ACCOUNTED_DATE Date,
  AMOUNT Float(2),
  CURRENCY Char(6),
  TRANSACTION_TYPE Text,
  ACCOUNT_NAME Text,
  TRANSACTION_DIRECTION Char(20),
  TARGET_ACCOUNT_NAME Text,
  PERSONAL_DESCRIPTION Text,
  VARIABLE_SYMBOL Int(10),
 PRIMARY KEY (ID,TRANSACTION_ID),
 UNIQUE ID (ID)
)
;

-- Create relationships section ------------------------------------------------- 

ALTER TABLE PARTNER_ACCOUNT ADD CONSTRAINT Relationship1 FOREIGN KEY (TRANSACTION_ID) REFERENCES TRANSACTION (ID) ON DELETE CASCADE ON UPDATE NO ACTION
;

ALTER TABLE CLIENT_ACCOUNT ADD CONSTRAINT Relationship2 FOREIGN KEY (TRANSACTION_ID) REFERENCES TRANSACTION (ID) ON DELETE CASCADE ON UPDATE NO ACTION
;

ALTER TABLE TRANSACTION_FROM_HTML ADD CONSTRAINT Relationship3 FOREIGN KEY (TRANSACTION_ID) REFERENCES TRANSACTION (ID) ON DELETE CASCADE ON UPDATE NO ACTION
;


